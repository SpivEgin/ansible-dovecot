# Authentication mechanisms
auth_mechanisms	= {{ " ".join(dovecot_auth_mechanisms) }}
{% if 'gssapi' in dovecot_auth_mechanisms %}
auth_gssapi_hostname = {{ ansible_fqdn }}
auth_krb5_keytab = {{ dovecot_krb5_keytab }}
{% endif %}

{% if dovecot_deny_users is defined and dovecot_deny_users %}
passdb {
    driver         = passwd-file
    args           = /etc/dovecot/dovecot.deny
    deny           = yes
    result_failure = return-fail
}
{% endif %}
{% if 'system' in dovecot_user_accounts %}
passdb {
    driver         = pam
    args           = session=yes dovecot
}
{% endif %}

